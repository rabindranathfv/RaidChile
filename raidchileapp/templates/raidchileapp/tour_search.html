{% extends "raidchileapp/base.html" %}
{% load static %}

{% block page_title %}{% if category %} {{ category.name }} {% else %} All Tours {% endif %} {% endblock page_title %}

{% block content %}

{# Setting url variables #}
{% url 'raidchileapp:search_all_tours' as all_url %}
{% url 'raidchileapp:tour_search_by_category' category.slug as cat_url %}

<form action="{% if category %}{{ cat_url }}{% else %}{{ all_url }}{% endif %}" method="GET" id="search-form">
	<!-- Search Bar Section -->
	<div class="w3-panel">
		<div class="w3-row">
			<div class="w3-col s1 w3-container"></div>
			<div class="w3-col s10">
				<div class="w3-panel w3-white w3-card-4 w3-padding-large">
					<div class="w3-row">
						<div class="w3-col s9 m9 l10">
							{{ search_form.search_terms }}
						</div>
						<div class="w3-col s3 m3 l2">
							<button type="submit" for="search-form" class="w3-button w3-block w3-dark-grey w3-border searchbar-btn"><i class="fa fa-search"></i> <span class="w3-hide-small">Search</span></button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!--  Content wrapper row (Contains sidebar and search results)  -->
	<div class="w3-row w3-white">
		<div class="w3-col m3 l2">
			<!-- Filter Search Sidebar goes here-->
			{% include "raidchileapp/search_sidebar.html" %}
		</div>
		<div class="w3-col m9 l10">
			<!--  Search result rows  -->
			<div class="w3-center">
				{% if category %}
					<h2> {{ category.name }} </h2>
				{% else %}
					<h2> All Tours </h2>
				{% endif %}
			</div>
			<div class="w3-row-padding w3-margin-top">
				{% for tour in tours %}
					<div class="w3-col m6 l4 w3-margin-bottom">
						<img src="{{ tour.images.all.first.image.url }}" alt="{{ tour.images.all.first.alternative }}" class="full-width-img">
						<div class="w3-container w3-white w3-card-2">
							<!-- Tour title -->
							<h4>{{ tour.name }}</h4>
							<!-- Tour adult sale prices -->
							<h6 class="w3-opacity">From CLP<span class="number-font"> {{ tour.adult_sale_price }}</span></h6>
							<h6>{{ tour.get_tour_type_display }} Tour: {{ tour.duration }} Hours</h6>
							<!-- Features Icons -->
							<p class="w3-large">
								{% for feature in tour.features.all %}
								<i class="fa {{ feature.icon }}"></i>
								{% endfor %}
							</p>
							<!-- Tour details button -->
							<a class="w3-button w3-block w3-black w3-margin-bottom" href="{{ tour.get_absolute_url }}">See more...</a>
						</div>
					</div>
				{% empty %}
					<div class="w3-col s12 w3-center w3-padding-64">
						<i class="w3-text-dark-gray fa fa-frown-o fa-5x"></i>
						<h4><em>We're sorry, there are no matching tours available for these filters right now.</em></h4>
					</div>
				{% endfor %}
			</div>
		</div>
	</div>
</form>
{% endblock content %}

{% block extra_js %}{% endblock extra_js %}